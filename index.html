<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coffee Shop Management Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .sidebar { height: 100vh; position: fixed; width: 260px; }
        .content { margin-left: 260px; padding: 20px; }
        @media (max-width: 768px) {
            .sidebar { width: 100%; height: auto; position: relative; }
            .content { margin-left: 0; }
        }
        .card { background: white; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); padding: 1.5rem; margin-bottom: 1.5rem; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #edf2f7; font-size: 0.875rem; }
        .input-inline { border: 1px solid #cbd5e0; border-radius: 4px; padding: 2px 5px; width: 80px; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

<div class="sidebar bg-slate-900 text-white p-6">
    <h2 class="text-2xl font-bold mb-8 text-orange-400">COFFEE DASHBOARD</h2>
    <nav class="space-y-4">
        <a href="#dashboard" class="block hover:text-orange-300">Overview Dashboard</a>
        <a href="#espresso" class="block hover:text-orange-300">Parameter Espresso</a>
        <a href="#ingredients" class="block hover:text-orange-300">Database Bahan Baku</a>
        <a href="#menu" class="block hover:text-orange-300">Database Menu & HPP</a>
    </nav>
</div>

<div class="content">
    <section id="dashboard">
        <h2 class="text-xl font-bold mb-4">Dashboard Overview</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="card bg-blue-50 border-l-4 border-blue-500">
                <p class="text-sm text-gray-600">Total Biaya Operasional / Hari</p>
                <h3 class="text-2xl font-bold">Rp 500.000</h3>
                <p class="text-xs text-gray-500 mt-2">Listrik: 200rb | Gaji: 300rb (Rata-rata)</p>
            </div>
            <div class="card bg-green-50 border-l-4 border-green-500">
                <p class="text-sm text-gray-600">Rata-rata Margin Toko</p>
                <h3 id="avg-margin" class="text-2xl font-bold">0%</h3>
            </div>
            <div class="card bg-orange-50 border-l-4 border-orange-500">
                <p class="text-sm text-gray-600">AI Global Insight</p>
                <p id="global-insight" class="text-xs italic text-gray-700 font-medium">Menghitung data...</p>
            </div>
        </div>
    </section>

    <section id="espresso" class="card">
        <h2 class="text-xl font-bold mb-4 text-slate-700">Database 4: Parameter Espresso (Editable)</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="p-4 border rounded-lg bg-orange-50">
                <h4 class="font-bold mb-2">Biji Kopi Toraja (KAKS)</h4>
                <div class="flex items-center gap-2 mb-2">
                    <label>Dose (gr):</label>
                    <input type="number" id="dose-kaks" value="18" class="input-inline" onchange="calculateAll()">
                    <label>Yield (ml):</label>
                    <input type="number" id="yield-kaks" value="60" class="input-inline" onchange="calculateAll()">
                </div>
                <p class="text-sm font-semibold">Cost per ml: <span id="cost-kaks" class="text-red-600"></span></p>
            </div>
            <div class="p-4 border rounded-lg bg-blue-50">
                <h4 class="font-bold mb-2">Biji Kopi Sumatra (DIKS)</h4>
                <div class="flex items-center gap-2 mb-2">
                    <label>Dose (gr):</label>
                    <input type="number" id="dose-diks" value="18" class="input-inline" onchange="calculateAll()">
                    <label>Yield (ml):</label>
                    <input type="number" id="yield-diks" value="36" class="input-inline" onchange="calculateAll()">
                </div>
                <p class="text-sm font-semibold">Cost per ml: <span id="cost-diks" class="text-red-600"></span></p>
            </div>
        </div>
    </section>

    <section id="ingredients" class="card">
        <h2 class="text-xl font-bold mb-4">Database 1: Bahan Baku</h2>
        <div class="overflow-x-auto">
            <table>
                <thead class="bg-gray-100">
                    <tr>
                        <th>Nama Bahan</th>
                        <th>Kategori</th>
                        <th>Brand</th>
                        <th>Harga Beli (Rp)</th>
                        <th>Isi (ml/gr)</th>
                        <th>Cost/Unit</th>
                        <th>Referensi Marketplace</th>
                    </tr>
                </thead>
                <tbody id="ingredient-table-body">
                    </tbody>
            </table>
        </div>
    </section>

    <section id="menu" class="card">
        <h2 class="text-xl font-bold mb-4">Database 3: Dashboard Menu, HPP, & Profit</h2>
        <div class="overflow-x-auto">
            <table>
                <thead class="bg-slate-800 text-white">
                    <tr>
                        <th>Menu</th>
                        <th>Tipe</th>
                        <th>HPP Total</th>
                        <th>Harga Jual</th>
                        <th>Margin %</th>
                        <th>Profit</th>
                        <th>Rekomendasi (50-70%)</th>
                        <th>AI Insight</th>
                    </tr>
                </thead>
                <tbody id="menu-table-body">
                    </tbody>
            </table>
        </div>
    </section>
</div>

<script>
// --- DATABASE 1: BAHAN BAKU (FINAL DATA) ---
const ingredients = {
    "Toraja Kaks": { cat: "Kopi", brand: "Lokal", unit: "gr", price: 230000, qty: 1000, ref: "Marketplace Biji Kopi" },
    "Sumatra Diks": { cat: "Kopi", brand: "Lokal", unit: "gr", price: 280000, qty: 1000, ref: "Marketplace Biji Kopi" },
    "Monin Caramel": { cat: "Syrup", brand: "Monin", unit: "ml", price: 165000, qty: 700, ref: "https://shopee.co.id/monin-official" },
    "Monin Vanilla": { cat: "Syrup", brand: "Monin", unit: "ml", price: 165000, qty: 700, ref: "https://tokopedia.com/monin" },
    "Monin Tiramisu": { cat: "Syrup", brand: "Monin", unit: "ml", price: 165000, qty: 700, ref: "Shopee Monin" },
    "Monin Banana": { cat: "Syrup", brand: "Monin", unit: "ml", price: 165000, qty: 700, ref: "Tokopedia Monin" },
    "Monin Butterscotch": { cat: "Syrup", brand: "Monin", unit: "ml", price: 165000, qty: 700, ref: "Shopee Monin" },
    "Monin Pandan": { cat: "Syrup", brand: "Monin", unit: "ml", price: 165000, qty: 700, ref: "Shopee Monin" },
    "Monin Apple": { cat: "Syrup", brand: "Monin", unit: "ml", price: 165000, qty: 700, ref: "Shopee Monin" },
    "Monin Melon": { cat: "Syrup", brand: "Monin", unit: "ml", price: 165000, qty: 700, ref: "Shopee Monin" },
    "Monin Grenadine": { cat: "Syrup", brand: "Monin", unit: "ml", price: 165000, qty: 700, ref: "Shopee Monin" },
    "Monin Lychee": { cat: "Syrup", brand: "Monin", unit: "ml", price: 165000, qty: 700, ref: "Shopee Monin" },
    "Monin Mango": { cat: "Syrup", brand: "Monin", unit: "ml", price: 165000, qty: 700, ref: "Shopee Monin" },
    "Monin Plum": { cat: "Syrup", brand: "Monin", unit: "ml", price: 165000, qty: 700, ref: "Shopee Monin" },
    "Monin Strawberry": { cat: "Syrup", brand: "Monin", unit: "ml", price: 165000, qty: 700, ref: "Shopee Monin" },
    "Monin Orange": { cat: "Syrup", brand: "Monin", unit: "ml", price: 165000, qty: 700, ref: "Shopee Monin" },
    "UHT Diamond": { cat: "Dairy", brand: "Diamond", unit: "ml", price: 215000, qty: 12000, ref: "1 Dus isi 12L" },
    "Susu Evaporasi": { cat: "Dairy", brand: "Sunbay", unit: "ml", price: 18000, qty: 380, ref: "Pasar Wajar" },
    "SKM": { cat: "Dairy", brand: "Cap Enaak", unit: "ml", price: 15000, qty: 490, ref: "Pasar Wajar" },
    "MaxCreamer": { cat: "Dairy", brand: "MaxCreamer", unit: "gr", price: 35000, qty: 500, ref: "Official Shop" },
    "Cheese Cream": { cat: "Dairy", brand: "Anchor", unit: "ml", price: 85000, qty: 1000, ref: "Marketplace" },
    "Oatside": { cat: "Dairy", brand: "Oatside", unit: "ml", price: 45000, qty: 1000, ref: "Official" },
    "Hydro Coco": { cat: "Lain-lain", brand: "Hydro", unit: "ml", price: 8000, qty: 500, ref: "Minimarket" },
    "Yakult": { cat: "Lain-lain", brand: "Yakult", unit: "pcs", price: 10000, qty: 5, ref: "Pasar" },
    "Bubuk Coklat": { cat: "Powder", brand: "Premium", unit: "gr", price: 90000, qty: 1000, ref: "Marketplace" },
    "Bubuk Matcha": { cat: "Powder", brand: "Premium", unit: "gr", price: 150000, qty: 1000, ref: "Marketplace" },
    "Bubuk Taro": { cat: "Powder", brand: "Premium", unit: "gr", price: 85000, qty: 1000, ref: "Marketplace" },
    "Bubuk Red Velvet": { cat: "Powder", brand: "Premium", unit: "gr", price: 85000, qty: 1000, ref: "Marketplace" },
    "Bubuk Avocado": { cat: "Powder", brand: "Premium", unit: "gr", price: 85000, qty: 1000, ref: "Marketplace" },
    "Bubuk Vanilla": { cat: "Powder", brand: "Premium", unit: "gr", price: 85000, qty: 1000, ref: "Marketplace" },
    "Skippy Peanut": { cat: "Lain-lain", brand: "Skippy", unit: "gr", price: 65000, qty: 340, ref: "Marketplace" },
    "Lotus Biscoff": { cat: "Lain-lain", brand: "Lotus", unit: "gr", price: 85000, qty: 400, ref: "Marketplace" },
    "Biskuit Lotus": { cat: "Lain-lain", brand: "Lotus", unit: "pcs", price: 25000, qty: 10, ref: "Marketplace" },
    "Gula Aren": { cat: "Lain-lain", brand: "Dainchi", unit: "gr", price: 45000, qty: 1000, ref: "1kg Aren" },
    "Simple Sugar": { cat: "Lain-lain", brand: "Home", unit: "ml", price: 15000, qty: 1000, ref: "Self Made" },
    "Sprite": { cat: "Lain-lain", brand: "CocaCola", unit: "ml", price: 15000, qty: 1500, ref: "Marketplace" },
    "Air Cleo": { cat: "Lain-lain", brand: "Cleo", unit: "ml", price: 20000, qty: 19000, ref: "Galon 19L" },
    "Es Batu": { cat: "Operasional", brand: "Kristal", unit: "gr", price: 70000, qty: 8000, ref: "8kg/8 Kantong" },
    "Packaging Hot": { cat: "Operasional", brand: "Generic", unit: "pcs", price: 900, qty: 1, ref: "Paper Cup + Lid" },
    "Packaging Ice": { cat: "Operasional", brand: "Generic", unit: "pcs", price: 900, qty: 1, ref: "Cup + Lid + Straw" }
};

// --- DATABASE 3: MENU & COMPOSITION ---
const menus = [
    { name: "Kopi Susu", cat: "Coffee Based", type: "Ice", price: 25000, recipe: { "SKM": 20, "MaxCreamer": 15, "Susu Evaporasi": 10, "UHT Diamond": 70 }, espressoType: "KAKS_SPECIAL", espressoVol: 35 },
    { name: "Tuan Rumah", cat: "Coffee Based", type: "Ice", price: 28000, recipe: { "Gula Aren": 25, "MaxCreamer": 25, "UHT Diamond": 100 }, espressoType: "KAKS", espressoVol: 30 },
    { name: "Tiramisu", cat: "Coffee Based", type: "Ice", price: 32000, recipe: { "Monin Tiramisu": 20, "SKM": 10, "MaxCreamer": 15, "UHT Diamond": 100, "Cheese Cream": 20 }, espressoType: "KAKS", espressoVol: 30 },
    { name: "Berry Cano", cat: "Specialty", type: "Ice", price: 25000, recipe: { "Monin Grenadine": 20, "Simple Sugar": 10, "Air Cleo": 100 }, espressoType: "DIKS", espressoVol: 30 },
    { name: "Matcha", cat: "Non Coffee", type: "Ice", price: 28000, recipe: { "Bubuk Matcha": 20, "SKM": 15, "MaxCreamer": 10, "Air Cleo": 20, "UHT Diamond": 110 }, espressoType: "NONE", espressoVol: 0 },
    { name: "Espresso Hot", cat: "Specialty", type: "Hot", price: 15000, recipe: {}, espressoType: "DIKS", espressoVol: 30 },
    { name: "Latte Ice", cat: "Specialty", type: "Ice", price: 28000, recipe: { "UHT Diamond": 120 }, espressoType: "DIKS", espressoVol: 30 }
];

function calculateAll() {
    const doseKaks = document.getElementById('dose-kaks').value;
    const yieldKaks = document.getElementById('yield-kaks').value;
    const doseDiks = document.getElementById('dose-diks').value;
    const yieldDiks = document.getElementById('yield-diks').value;

    // Hitung Cost Espresso per ml
    const costKaksPerMl = (ingredients["Toraja Kaks"].price / 1000 * doseKaks) / yieldKaks;
    const costDiksPerMl = (ingredients["Sumatra Diks"].price / 1000 * doseDiks) / yieldDiks;

    document.getElementById('cost-kaks').innerText = `Rp ${costKaksPerMl.toFixed(2)}/ml`;
    document.getElementById('cost-diks').innerText = `Rp ${costDiksPerMl.toFixed(2)}/ml`;

    renderIngredients();
    renderMenu(costKaksPerMl, costDiksPerMl, doseKaks);
}

function renderIngredients() {
    const tbody = document.getElementById('ingredient-table-body');
    tbody.innerHTML = '';
    for (let key in ingredients) {
        const item = ingredients[key];
        const unitCost = item.price / item.qty;
        tbody.innerHTML += `<tr>
            <td class="font-bold">${key}</td>
            <td>${item.cat}</td>
            <td>${item.brand}</td>
            <td>${item.price.toLocaleString()}</td>
            <td>${item.qty} ${item.unit}</td>
            <td class="text-orange-600 font-bold">Rp ${unitCost.toFixed(2)}</td>
            <td class="text-blue-500 text-xs truncate max-w-[150px]"><a href="#">${item.ref}</a></td>
        </tr>`;
    }
}

function renderMenu(costKaks, costDiks, doseKaks) {
    const tbody = document.getElementById('menu-table-body');
    tbody.innerHTML = '';
    let totalMargin = 0;

    menus.forEach(menu => {
        let hpp = 0;
        // 1. Hitung Recipe
        for (let ing in menu.recipe) {
            hpp += (ingredients[ing].price / ingredients[ing].qty) * menu.recipe[ing];
        }
        
        // 2. Hitung Espresso
        if (menu.espressoType === "KAKS") hpp += costKaks * menu.espressoVol;
        if (menu.espressoType === "DIKS") hpp += costDiks * menu.espressoVol;
        if (menu.espressoType === "KAKS_SPECIAL") {
            // Rasio khusus kopi susu: 18g jadi 35ml. HPP per ml beda.
            const costKaksSpecial = (ingredients["Toraja Kaks"].price / 1000 * doseKaks) / 35;
            hpp += costKaksSpecial * 35;
        }

        // 3. Packaging & Es Batu
        hpp += 900; // Cup & Lid
        if (menu.type === "Ice") {
            hpp += (70000 / 8000) * 100; // Es batu 100gr
        }

        const profit = menu.price - hpp;
        const margin = (profit / menu.price) * 100;
        totalMargin += margin;

        const recMin = hpp / 0.5;
        const recMax = hpp / 0.3;

        // AI Insight Logic
        let insight = margin < 50 ? "âš ï¸ Margin Tipis. Naikkan harga!" : "âœ… Sehat.";
        if (hpp > 15000) insight = "ðŸ’Ž High-End Cost.";

        tbody.innerHTML += `<tr>
            <td class="font-bold">${menu.name}</td>
            <td><span class="px-2 py-1 bg-gray-200 rounded text-xs">${menu.type}</span></td>
            <td class="text-red-600 font-bold">Rp ${Math.round(hpp).toLocaleString()}</td>
            <td>Rp ${menu.price.toLocaleString()}</td>
            <td class="${margin < 50 ? 'text-red-500' : 'text-green-600'} font-bold">${margin.toFixed(1)}%</td>
            <td>Rp ${Math.round(profit).toLocaleString()}</td>
            <td class="text-xs text-gray-500">Rp ${Math.round(recMin).toLocaleString()} - ${Math.round(recMax).toLocaleString()}</td>
            <td class="text-xs italic">${insight}</td>
        </tr>`;
    });

    const avg = totalMargin / menus.length;
    document.getElementById('avg-margin').innerText = `${avg.toFixed(1)}%`;
    document.getElementById('global-insight').innerText = avg < 50 ? 
        "PERINGATAN: Rata-rata margin di bawah 50%. Segera evaluasi harga jual atau cari substitusi bahan baku yang lebih murah untuk menjaga profitabilitas operasional." : 
        "PERFORMA BAGUS: Rata-rata margin sudah ideal di atas 50%. Fokus pada volume penjualan dan kualitas konsistensi rasa.";
}

// Initial Load
calculateAll();
</script>

</body>
</html>
